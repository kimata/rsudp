--- original/rsudp/helpers.py	2026-01-06 09:07:55.029230999 +0900
+++ modified/rsudp/helpers.py	2026-01-06 09:04:57.057078433 +0900
@@ -133,7 +133,7 @@
 			   sender=s, announce=False)
 
 
-def msg_alarm(event_time):
+def msg_alarm(event_time, sta_val=None, lta_val=None, max_count=None):
 	'''
 	This function constructs the ``ALARM`` message as a bytes object.
 	Currently this is only used by :py:class:`rsudp.p_producer.Producer`
@@ -148,11 +148,23 @@
 		>>> msg_alarm(ti)
 		b'ALARM 2020-01-01T00:00:00.599Z'
 
+		>>> msg_alarm(ti, 0.5, 0.25, 1234)
+		b'ALARM 2020-01-01T00:00:00.599Z STA=0.500000 LTA=0.250000 COUNT=1234'
+
 	:param obspy.core.utcdatetime.UTCDateTime event_time: the datetime object to serialize and convert to bytes
+	:param float sta_val: Short Term Average value at trigger time (optional)
+	:param float lta_val: Long Term Average value at trigger time (optional)
+	:param int max_count: Maximum count value at trigger time (optional)
 	:rtype: bytes
 	:return: the ``ALARM`` message, ready to be put on the queue
 	'''
-	return b'ALARM %s' % bytes(str(event_time), 'utf-8')
+	base_msg = b'ALARM %s' % bytes(str(event_time), 'utf-8')
+	extra_info = b''
+	if sta_val is not None and lta_val is not None:
+		extra_info += b' STA=%f LTA=%f' % (sta_val, lta_val)
+	if max_count is not None:
+		extra_info += b' COUNT=%d' % max_count
+	return base_msg + extra_info
 
 
 def msg_reset(reset_time):
@@ -266,6 +278,72 @@
 	return msg.decode('utf-8').split(' ')[2]
 
 
+def get_msg_sta_lta(msg):
+	'''
+	This function extracts STA and LTA values from ``ALARM`` messages.
+
+	For example:
+
+	.. code-block:: python
+
+		>>> from obspy import UTCDateTime
+		>>> ti = UTCDateTime(2020, 1, 1, 0, 0, 0, 599000, precision=3)
+		>>> msg = msg_alarm(ti, 0.5, 0.25)
+		>>> get_msg_sta_lta(msg)
+		(0.5, 0.25)
+
+	:param bytes msg: the bytes-formatted ``ALARM`` message to decode
+	:rtype: tuple or None
+	:return: (sta_val, lta_val) tuple if STA/LTA values are present, None otherwise
+	'''
+	msg_str = msg.decode('utf-8')
+	if 'STA=' in msg_str and 'LTA=' in msg_str:
+		try:
+			parts = msg_str.split(' ')
+			sta_val = None
+			lta_val = None
+			for part in parts:
+				if part.startswith('STA='):
+					sta_val = float(part.split('=')[1])
+				elif part.startswith('LTA='):
+					lta_val = float(part.split('=')[1])
+			if sta_val is not None and lta_val is not None:
+				return (sta_val, lta_val)
+		except (ValueError, IndexError):
+			pass
+	return None
+
+
+def get_msg_max_count(msg):
+	'''
+	This function extracts the max count value from ``ALARM`` messages.
+
+	For example:
+
+	.. code-block:: python
+
+		>>> from obspy import UTCDateTime
+		>>> ti = UTCDateTime(2020, 1, 1, 0, 0, 0, 599000, precision=3)
+		>>> msg = msg_alarm(ti, 0.5, 0.25, 1234)
+		>>> get_msg_max_count(msg)
+		1234
+
+	:param bytes msg: the bytes-formatted ``ALARM`` message to decode
+	:rtype: int or None
+	:return: max_count value if present, None otherwise
+	'''
+	msg_str = msg.decode('utf-8')
+	if 'COUNT=' in msg_str:
+		try:
+			parts = msg_str.split(' ')
+			for part in parts:
+				if part.startswith('COUNT='):
+					return int(part.split('=')[1])
+		except (ValueError, IndexError):
+			pass
+	return None
+
+
 def deconv_vel_inst(self, trace, output):
 	'''
 	.. role:: pycode(code)
